(this["webpackJsonpclassic-percep"]=this["webpackJsonpclassic-percep"]||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n(1),s=n.n(a),r=n(8),o=n.n(r),c=(n(15),n(9)),l=n(2);n(16);function u(e){return e.filter((function(e,t){return(t+1)%4===0})).map((function(e){return 255===e?1:0}))}var g=function(e){var t,n=Object(a.useState)(!1),s=Object(l.a)(n,2),r=s[0],o=s[1],c=Object(a.useState)(!1),g=Object(l.a)(c,2),h=g[0],d=g[1],f=Object(a.useRef)(null),p=(null===(t=f.current)||void 0===t?void 0:t.getBoundingClientRect())||{left:0,top:0},b=function(){var e=f.current.getContext("2d");null===e||void 0===e||e.clearRect(0,0,200,200)};return Object(i.jsxs)("div",{style:{display:"flex",alignItems:"center",flexDirection:"column",marginTop:40},children:[Object(i.jsxs)("label",{children:["Class: ",e.label]}),Object(i.jsx)("div",{style:{backgroundColor:"grey",display:"flex",width:200,border:"1px solid black"},children:Object(i.jsx)("canvas",{width:"200px",height:"200px",style:{backgroundColor:"white"},ref:f,onMouseDown:function(e){if(f.current){o(!0);var t=f.current.getContext("2d");t.moveTo(e.clientX-p.left,e.clientY-p.top),t.beginPath(),t.lineWidth=10,t.strokeStyle="black"}},onMouseMove:function(e){if(r&&f.current){var t=f.current.getContext("2d");t.lineTo(e.clientX-p.left,e.clientY-p.top),t.stroke()}},onMouseUp:function(e){return o(!1)},onMouseLeave:function(){return o(!1)}})}),Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",borderTop:"1px solid black",padding:"5px",marginTop:10},children:[Object(i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[Object(i.jsx)("button",{onClick:function(){"learning"===e.type&&function(){var t=f.current.getContext("2d"),n=null===t||void 0===t?void 0:t.getImageData(0,0,200,200).data;if(n){var i=u(n);e.onTrain(Array.from(i)),b()}else console.log("Something went wrong while training")}(),"guessing"===e.type&&function(){var t=f.current.getContext("2d"),n=null===t||void 0===t?void 0:t.getImageData(0,0,200,200).data;if(n){var i=u(n);e.onGuess(Array.from(i))}else console.log("Something went wrong while training")}()},style:{margin:"0 5px"},children:"guessing"===e.type?"Guess":"Train"}),Object(i.jsx)("button",{onClick:b,style:{margin:"0 5px"},children:"Clear"}),Object(i.jsx)("button",{onClick:function(){var t=f.current.getContext("2d").getImageData(0,0,200,200);e.handleCopy(t)},style:{margin:"0 5px"},children:"Copy"}),Object(i.jsx)("button",{onClick:function(){if(null!==e.copiedImage){var t=f.current.getContext("2d");b(),null===t||void 0===t||t.putImageData(e.copiedImage,0,0)}},style:{margin:"0 5px"},children:"Paste"})]}),"learning"===e.type?Object(i.jsx)("button",{onClick:function(){var t=f.current.getContext("2d");if(null===t||void 0===t||t.clearRect(0,0,200,200),"learning"===e.type){if(h)return void d(!1);for(var n=t.createImageData(200,200),i=0;i<n.data.length;i+=4){var a=e.weights[i/4];n.data[i+0]=0,n.data[i+1]=0,n.data[i+2]=0,n.data[i+3]=a>0&&a<1?parseInt("".concat(255*a),10):0}t.putImageData(n,0,0),d(!0)}},children:h?"Heatmap Off":"Heatmap"}):null]})]})},h=n(5),d=n(7);function f(e,t){if(e.length!==t.length)throw new Error("Vector`s lengths should be equal");return e.reduce((function(e,n,i){return e+n*t[i]}),0)}function p(){return null!==localStorage.getItem("weights")?JSON.parse(localStorage.getItem("weights")):null}function b(e){var t=p();return null!==t?t.findIndex((function(t){return t.name===e})):-1}var m=function e(t,n){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;if(Object(h.a)(this,e),this.weights=[],this.threshold=void 0,this.className=void 0,this.adjustWeights=function(e,t){var n=f(e,i.weights);"positive"===t&&n<0&&(i.weights=i.weights.map((function(t,n){return t+.1*e[n]}))),"negative"===t&&n>=0&&(i.weights=i.weights.map((function(t,n){return t-.1*e[n]})));var a=b(i.className);if(-1!==a){var s=p();s[a]=Object(d.a)(Object(d.a)({},s[a]),{},{weights:i.weights}),localStorage.setItem("weights",JSON.stringify(s))}else{var r=p();null!==r?(r.push({name:i.className,weights:i.weights}),localStorage.setItem("weights",JSON.stringify(r))):localStorage.setItem("weights",JSON.stringify([{name:i.className,weights:i.weights}]))}},this.guess=function(e){if(console.log("GUESSING.... sizing:",i.weights),e.length!==i.weights.length)throw new Error("insufficient number of inputs");var t=f(e,i.weights);return console.log("weightedInputs",t),1/(1+Math.pow(Math.E,-(i.threshold+t)))},this.threshold=a,this.className=n,null===localStorage.getItem("weights"))for(var s=0;s<t;s++)this.weights.push(Math.random());else if(null!==localStorage.getItem("weights")){var r=b(this.className);if(-1!==r)this.weights=p()[r].weights.map((function(e){return-1*-e.toFixed(5)}));else for(var o=0;o<t;o++)this.weights.push(Math.random())}},j=function e(t){var n=this;Object(h.a)(this,e),this.classes=[],this.imageSizing=void 0,this.addClass=function(e){n.classes.find((function(t){return t.name===e}))?console.log("Class with such name already exists"):n.classes.push({name:e,neuron:new m(n.imageSizing,e)})},this.trainClass=function(e,t){var i=n.classes.find((function(t){return t.name===e}));i?(i.neuron.adjustWeights(t,"positive"),n.classes.forEach((function(n){n.name!==e&&n.neuron.adjustWeights(t,"negative")}))):console.log("No class with such name")},this.recognize=function(e){var t=n.classes.map((function(t){var n=t.neuron.guess(e);return{name:t.name,value:n}}));return t.sort((function(e,t){return t.value-e.value})),t[0]},this.imageSizing=t};function v(){return JSON.parse(localStorage.getItem("weights")||"[]").map((function(e){return e.name}))}function w(e,t){var n=e.classes.find((function(e){return e.name===t}));return n?n.neuron.weights:[]}var x=function(){var e=Object(a.useState)(v()),t=Object(l.a)(e,2),n=t[0],s=t[1],r=Object(a.useState)(new j(4e4)),o=Object(l.a)(r,1)[0],u=Object(a.useState)(""),h=Object(l.a)(u,2),d=h[0],f=h[1],p=Object(a.useState)(null),b=Object(l.a)(p,2),m=b[0],x=b[1],O=Object(a.useState)("?"),y=Object(l.a)(O,2),C=y[0],S=y[1],I=Object(a.useCallback)((function(){o.addClass(d),s([].concat(Object(c.a)(n),[d])),f("")}),[n,s,d,f,o]),k=function(e){x(e)};return Object(a.useEffect)((function(){v().map(o.addClass)}),[o]),Object(a.useEffect)((function(){fetch("")}),[]),console.log("network",o),Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",padding:"15px"},children:n.map((function(e){return Object(i.jsx)(g,{type:"learning",label:e,copiedImage:m,onTrain:function(t){return o.trainClass(e,t)},handleCopy:k,weights:w(o,e)},e)}))}),Object(i.jsx)("input",{value:d,onChange:function(e){return f(e.currentTarget.value)}}),Object(i.jsx)("button",{onClick:I,children:"Add Class"}),Object(i.jsx)("div",{style:{border:"1px solid green"},children:Object(i.jsx)(g,{type:"guessing",label:C,copiedImage:m,onGuess:function(e){return S(o.recognize(e).name)},handleCopy:k})})]})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),i(e),a(e),s(e),r(e)}))};o.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(x,{})}),document.getElementById("root")),O()}},[[17,1,2]]]);
//# sourceMappingURL=main.d6971fde.chunk.js.map